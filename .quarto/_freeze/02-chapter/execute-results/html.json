{
  "hash": "bd3975cb3fccd7d0ff7980bc292332db",
  "result": {
    "markdown": "---\ntitle: \"Data and measurement\" \nauthor: \"Sam Langton\"\nformat:\n  html: \n    grid: \n      margin-width: 350px\n  pdf: default\nreference-location: margin\ncitation-location: margin\n---\n\n\n## Summary\n\nBefore fitting a model, you need to understand the data and the measurements, the numbers and where they come from. This chapter demonstrates through examples how to use graphical tools to explore understand and measurements.\n\nThe first example (graphing Human Development Index) shows that you understand data better when you plot them in different ways. The second example (Political Ideology and party identification) show that details of measurement can be important and that gaps between measurement and reality can be large. \n\nKeep in mind that the issue of measurement is important because of two reasons: \\\n- We need to understand what the data actually mean.\\\n- Learning about accuracy, reliability and validity will set the foundation for understanding variance, correlation, and error (all part of linear models).   \n\nFeatures of data quality:\n\nA measure is **valid** to the degree that it represents what you are trying to measure. **Validity** of a measuring process is defined as a property of giving the right answer across a wide range of plausible scenarios.\n\nA measure is **reliable** to the degree that it gives the same answer when applied to the same situation. A **reliable** measure is one that is precise and stable.\n\n**Selection** is the third feature of data quality, the idea that the data you see can be a non-representative sample of a larger population that you will not see.\n\nSeveral visualization suggestions are given in this chapter. \n\nThree uses of graphics in statistical analysis are given: \\\n- Displays of raw data (part of explorative analysis), just to understand data;  \\\n- Graphs of fitted models and inferences (to understand model fits); \\\n- Graphs as communication tools (to communicate results).\n\n\n\n## Presentation\nOn 12-12-2023 Sam Langton gave this presentation on chapter 2 of *Regression and Other Stories* for the *Reading Club Session (chapter 2). His script you can also find [here]().\n\nFirst load packages for this chapter.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(foreign)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(ggplot2)\nlibrary(stringr)\nlibrary(broom)\nlibrary(maps)\nlibrary(sf)\nlibrary(rosdata)\n```\n:::\n\n\n\nGeneral discussion points he put on the agenda:    \n- New GitHub repo intro.    \n- Difference between visualisation issues and then scrutiny over a composite\nmeasure (section 2.1).   \n- Validity and reliability: any examples from people's work?    \n- What did people think of the plots? I had some queries (e.g., 2.5, 2.7).    \n- Grammar of Graphics-style approach (but without ggplot2 code).   \n- Plotting regression results.\n\n### Map visual\n\nLoad in HDI data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# take care of the path to the data\n\nhdi_df <- read.table(\"~/Desktop/WERK/Gelman/reading_club_GIT/Reading_club_Git/ROS-Examples-master/HDI/data/hdi.dat\", header = TRUE)\n```\n:::\n\n\nGet state boundaries using the `maps`-package.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstates_sf <- maps::map(\"state\",\n                       plot = FALSE,\n                       fill = TRUE) %>% \n  st_as_sf()\n```\n:::\n\n\nPlot this.\n\n\n::: {.cell .column-margin}\n\n```{.r .cell-code}\nggplot(data = states_sf) +\n  geom_sf()\n```\n\n::: {.cell-output-display}\n![Map of states](02-chapter_files/figure-html/plot-state-1.png){width=672}\n:::\n:::\n\n\nJoin the HDI data to the spatial polygons.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstate_hdi_sf <- hdi_df |>\n  mutate(ID = str_to_lower(state)) |> \n  right_join(states_sf) |>\n  st_as_sf()\n```\n:::\n\n\nMap out HDI using a continuous scale.\n\n\n::: {.cell .column-margin}\n\n```{.r .cell-code}\nggplot(data = state_hdi_sf) +\n  geom_sf(mapping = aes(fill = hdi)) +\n  scale_fill_viridis_c()\n```\n\n::: {.cell-output-display}\n![Map of HDI](02-chapter_files/figure-html/map-hdi-1.png){width=672}\n:::\n:::\n\n\n### Scatterplots\n\nLoad in the income/hdi data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# take care of the path to the data\n\nincome_df <- read.dta(\"~/Desktop/WERK/Gelman/reading_club_GIT/Reading_club_Git/ROS-Examples-master/HDI/data/state vote and income, 68-00.dta\")\n```\n:::\n\n\nCreate a common id again.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nincome_df <- income_df %>% \n  mutate(st_state = str_to_lower(st_state))\n```\n:::\n\n\n\nScatterplots.\n\n\n::: {.cell .column-margin}\n\n```{.r .cell-code}\n# Remark: why not a scatterplot?\n\nincome_hdi_df <-income_df %>%\n  filter(st_year == 2000) %>%\n  ggplot() +\n  geom_text(mapping = aes(x = st_income, y = hdi, label = st_stateabb))\n  geom_point(mapping = aes(x = st_income, y = hdi))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nmapping: x = ~st_income, y = ~hdi \ngeom_point: na.rm = FALSE\nstat_identity: na.rm = FALSE\nposition_identity \n```\n:::\n:::\n\n### Names plots\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# take care of the path to the data\n\nnames_df <- read.csv(\"~/Desktop/WERK/Gelman/ROS-book/ROS-book/ROS-Examples-master/Names/data/allnames_clean.csv\") %>% \n  as_tibble()\n```\n:::\n\n\n\nMake it long and filter.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnames_long_df <- names_df |> \n  pivot_longer(cols = c(-X, -name, -sex), names_to = \"year\", values_to = \"number\",\n               names_prefix = \"X\") |>\n  mutate(year = as.numeric(year),\n         last_letter = str_sub(name, start = -1)) \n```\n:::\n\n\nNow Figure 2.7.\n\n\n::: {.cell .column-margin}\n\n```{.r .cell-code}\nnames_long_df %>% \n  filter(year == 1906 | year == 1956 | year == 2006,\n         sex == \"M\") %>% \n  group_by(year, last_letter) %>% \n  summarise(counts = sum(number)) %>% \n  ungroup() %>% \n  group_by(year) %>% \n  mutate(total_counts = sum(counts),\n         prop_counts  = counts/total_counts) %>% \n  ungroup() %>% \n  ggplot(data = .) +\n  geom_col(mapping = aes(x = last_letter, y = prop_counts,\n                         fill = as.factor(year)), \n           position = \"dodge\") +\n  facet_wrap(~year)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'year'. You can override using the\n`.groups` argument.\n```\n:::\n\n::: {.cell-output-display}\n![Figure 2.7](02-chapter_files/figure-html/figure-2.7-1.png){width=672}\n:::\n:::\n\n\nMake a line graph.\n\n\n::: {.cell .column-margin}\n\n```{.r .cell-code}\nnames_long_df %>% \n  filter(sex == \"M\") %>%\n  group_by(year, last_letter) %>% \n  summarize(yearly_counts = sum(number)) %>% \n  ungroup() %>% \n  group_by(year) %>% \n  mutate(year_total  = sum(yearly_counts),\n         yearly_prop = yearly_counts/year_total,\n         end_letter  = if_else(last_letter == \"d\" |\n                               last_letter == \"y\" |\n                               last_letter == \"n\",\n                               last_letter,\n                               \"(other)\")) %>% \n  ungroup() %>% \n  ggplot(data = .) +\n  geom_line(mapping = aes(x = year, y = yearly_prop, group = last_letter,\n                          colour = end_letter)) +\n  scale_colour_manual(values = c(\"grey80\", \"black\", \"tomato\", \"dodgerblue\")) \n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'year'. You can override using the\n`.groups` argument.\n```\n:::\n\n::: {.cell-output-display}\n![Line graph](02-chapter_files/figure-html/line-graph-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "02-chapter_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}