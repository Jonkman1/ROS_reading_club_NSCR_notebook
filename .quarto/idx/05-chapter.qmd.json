{"title":"Simulation","markdown":{"yaml":{"title":"Simulation","author":"X Y (Chair)","format":{"html":{"grid":{"margin-width":"350px"}},"pdf":"default"},"reference-location":"margin","citation-location":"margin"},"headingText":"Summary","containsRefs":false,"markdown":"\n\n\nIn this book *Regression and Other Stories* and in practice Gelman et all. use simulation for different reasons: \\\n- use probability models to mimic variation in the world (tools of simulation can help us better to understand how this variation plays out); \\\n- use simulation to approximate the sampling distribution of data and propagate this to the sampling distribution of statistical estimates and procedures;\\\n- regression models are not deterministic; they produce probabilisitc predictions. Simulation is the most convenient and general way to represent uncertainties in forecasts. \n\nBecause of this, chapter 5 introduces simulations (basic ideas and tools to perform it in `R`).\n\n\nThere are many settings where it makes sense to use a set of simulation draws to summarize a distribution, which can represent a simulation from a probability model, a prediction for a future outcome from a fitted regression, or uncertainty about parameters in a fitted model.\n\n\nIn this book they use the Bayesian simulation approach for regression models. Bootstrap is also a simulation approach, but it is not as general as Bayesian simulation. It is very general, any estimate can be simulated, and it is easy to use with complex models. But it has limitations (for example leading to an answer with an inappropriately high level of certainty). This method is not used in the book.\n\n## Presentation\n\nDifferent examples of simulations of discrete, continuous, and mixed discrete/ continuous models are presented in this chapter.\n\nIt starts with a discrete model example: Across the world the probability a baby will be born a girl is about $48.8\\%$, with the probability of a boy then being about $51.2\\%$. If you wanted to get a sense of how many girls you'd expect out of 400 births, you could simulate using the `rbinom()` function.\n\n```{r, message=FALSE, warning=FALSE}\n#| label: rbinom\n\n\nset.seed(5)\n# use set seed here because we want to get the same results every time we run the code\n\nrbinom(n = 1, size = 400, prob = 0.488)\n\n```\n\nGraph results of 10000 simulations:\n\n```{r}\n#| label: rbinom_graph\n#| fig.cap: Simulating 400 births\n#| column: margin\n\nlibrary(tidyverse)\n\n\nset.seed(5)\n# set the global plotting theme\ntheme_set(theme_linedraw() +\n            theme(panel.grid = element_blank()))\n\n# set the seed\nset.seed(5)\n\n# simulate\ntibble(girls = rbinom(n = 10000, size = 400, prob = .488)) %>% \n  \n# plot\nggplot(aes(x = girls)) +\ngeom_histogram(binwidth = 2) +\nscale_x_continuous(\"Number of girls out of 400 single births \\ \n                   in 10.000 observations\", breaks = 7:9 * 25) +\nscale_y_continuous(expand = expansion(mult = c(0, 0.05)))\n```\n\nAlso simulations of other models are presented. For example, the normal, binomial and Poisson distributions are presented.\n\nDefine mean=3 and sd=0,5\n\n```{r}\n#| label: def\n\nmean = 3\nsd = 0.5\nn_sims = 10000\n\n```\n\nPlot the results of 10000 simulations of a normal distribution with mean=3 and sd=0,5:\n\nThen plot the results in histograms:\n\n```{r}\n#| label: normal\n#| fig.cap: Simulating a normal distribution\n#| column: margin\n\nlibrary(tidyverse)\n\nset.seed(660)\n\nd <- tibble(x = rnorm(n_sims, mean = mean, sd = sd))\n\nd %>% \n  ggplot(aes(x)) +\n  geom_histogram(binwidth = 0.1) +\n  labs(\n    title =\n      str_glue(\n        \"Normal distribution with mean {mean} and standard deviation {sd}\"\n      )\n  )\n\n```\n\nHere data for a binomial distribution:\n\n```{r}\n#| label: binomial\n\nsize <- 20\nprob <- 0.6\n\n```\n\nLet us plot the results of 10000 simulations of a binomial distribution with size=20 and prob=0.6:\n\n```{r}\n#| label: binomial_graph\n#| fig.cap: Simulating a binomial distribution\n#| column: margin\n\nset.seed(660)\n\nd <- tibble(x = rbinom(n_sims, size = size, prob = prob))\n\nd %>% ggplot(aes(x)) +\n  geom_bar() +\n  scale_x_continuous(breaks = seq(0, size), minor_breaks = NULL) +\n  coord_cartesian(xlim = c(0, size)) +\n  labs(\n    title =\n      str_glue(\n        \"Binomial distribution with size {size} and probability {prob}\"\n      )\n  )\n\n```\n\nNow a Poisson distribution with mean 5:\n\n```{r}\n#| label: poisson\n#| fig.cap: Simulating a Poisson distribution\n#| column: margin\n\nlambda <- 5\n\nset.seed(660)\n\nd <- tibble(x = rpois(n_sims, lambda))\n\nd %>% ggplot(aes(x)) +\n  geom_bar() +\n  scale_x_continuous(breaks = seq(0, 2 * lambda), minor_breaks = NULL) +\n  coord_cartesian(xlim = c(0, 2 * lambda)) +\n  labs(\n    title = str_glue(\"Poisson distribution with mean {lambda}\")\n  )\n```\n\n\nHere you find a **tidyverse** oriented flow, as Kurz defined it.\n\n```{r}\nset.seed(5)\n\ntibble(z = rnorm(1e4, mean = 5, sd = 2)) %>% \n  summarise(mean   = mean(z),\n            median = median(z),\n            sd     = sd(z),\n            mad_sd = mad(z))\n```\n\n","srcMarkdownNoYaml":"\n\n## Summary\n\nIn this book *Regression and Other Stories* and in practice Gelman et all. use simulation for different reasons: \\\n- use probability models to mimic variation in the world (tools of simulation can help us better to understand how this variation plays out); \\\n- use simulation to approximate the sampling distribution of data and propagate this to the sampling distribution of statistical estimates and procedures;\\\n- regression models are not deterministic; they produce probabilisitc predictions. Simulation is the most convenient and general way to represent uncertainties in forecasts. \n\nBecause of this, chapter 5 introduces simulations (basic ideas and tools to perform it in `R`).\n\n\nThere are many settings where it makes sense to use a set of simulation draws to summarize a distribution, which can represent a simulation from a probability model, a prediction for a future outcome from a fitted regression, or uncertainty about parameters in a fitted model.\n\n\nIn this book they use the Bayesian simulation approach for regression models. Bootstrap is also a simulation approach, but it is not as general as Bayesian simulation. It is very general, any estimate can be simulated, and it is easy to use with complex models. But it has limitations (for example leading to an answer with an inappropriately high level of certainty). This method is not used in the book.\n\n## Presentation\n\nDifferent examples of simulations of discrete, continuous, and mixed discrete/ continuous models are presented in this chapter.\n\nIt starts with a discrete model example: Across the world the probability a baby will be born a girl is about $48.8\\%$, with the probability of a boy then being about $51.2\\%$. If you wanted to get a sense of how many girls you'd expect out of 400 births, you could simulate using the `rbinom()` function.\n\n```{r, message=FALSE, warning=FALSE}\n#| label: rbinom\n\n\nset.seed(5)\n# use set seed here because we want to get the same results every time we run the code\n\nrbinom(n = 1, size = 400, prob = 0.488)\n\n```\n\nGraph results of 10000 simulations:\n\n```{r}\n#| label: rbinom_graph\n#| fig.cap: Simulating 400 births\n#| column: margin\n\nlibrary(tidyverse)\n\n\nset.seed(5)\n# set the global plotting theme\ntheme_set(theme_linedraw() +\n            theme(panel.grid = element_blank()))\n\n# set the seed\nset.seed(5)\n\n# simulate\ntibble(girls = rbinom(n = 10000, size = 400, prob = .488)) %>% \n  \n# plot\nggplot(aes(x = girls)) +\ngeom_histogram(binwidth = 2) +\nscale_x_continuous(\"Number of girls out of 400 single births \\ \n                   in 10.000 observations\", breaks = 7:9 * 25) +\nscale_y_continuous(expand = expansion(mult = c(0, 0.05)))\n```\n\nAlso simulations of other models are presented. For example, the normal, binomial and Poisson distributions are presented.\n\nDefine mean=3 and sd=0,5\n\n```{r}\n#| label: def\n\nmean = 3\nsd = 0.5\nn_sims = 10000\n\n```\n\nPlot the results of 10000 simulations of a normal distribution with mean=3 and sd=0,5:\n\nThen plot the results in histograms:\n\n```{r}\n#| label: normal\n#| fig.cap: Simulating a normal distribution\n#| column: margin\n\nlibrary(tidyverse)\n\nset.seed(660)\n\nd <- tibble(x = rnorm(n_sims, mean = mean, sd = sd))\n\nd %>% \n  ggplot(aes(x)) +\n  geom_histogram(binwidth = 0.1) +\n  labs(\n    title =\n      str_glue(\n        \"Normal distribution with mean {mean} and standard deviation {sd}\"\n      )\n  )\n\n```\n\nHere data for a binomial distribution:\n\n```{r}\n#| label: binomial\n\nsize <- 20\nprob <- 0.6\n\n```\n\nLet us plot the results of 10000 simulations of a binomial distribution with size=20 and prob=0.6:\n\n```{r}\n#| label: binomial_graph\n#| fig.cap: Simulating a binomial distribution\n#| column: margin\n\nset.seed(660)\n\nd <- tibble(x = rbinom(n_sims, size = size, prob = prob))\n\nd %>% ggplot(aes(x)) +\n  geom_bar() +\n  scale_x_continuous(breaks = seq(0, size), minor_breaks = NULL) +\n  coord_cartesian(xlim = c(0, size)) +\n  labs(\n    title =\n      str_glue(\n        \"Binomial distribution with size {size} and probability {prob}\"\n      )\n  )\n\n```\n\nNow a Poisson distribution with mean 5:\n\n```{r}\n#| label: poisson\n#| fig.cap: Simulating a Poisson distribution\n#| column: margin\n\nlambda <- 5\n\nset.seed(660)\n\nd <- tibble(x = rpois(n_sims, lambda))\n\nd %>% ggplot(aes(x)) +\n  geom_bar() +\n  scale_x_continuous(breaks = seq(0, 2 * lambda), minor_breaks = NULL) +\n  coord_cartesian(xlim = c(0, 2 * lambda)) +\n  labs(\n    title = str_glue(\"Poisson distribution with mean {lambda}\")\n  )\n```\n\n\nHere you find a **tidyverse** oriented flow, as Kurz defined it.\n\n```{r}\nset.seed(5)\n\ntibble(z = rnorm(1e4, mean = 5, sd = 2)) %>% \n  summarise(mean   = mean(z),\n            median = median(z),\n            sd     = sd(z),\n            mad_sd = mad(z))\n```\n\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","reference-location":"margin","output-file":"05-chapter.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.450","bibliography":["references.bib"],"theme":"cosmo","title":"Simulation","author":"X Y (Chair)","citation-location":"margin","grid":{"margin-width":"350px"}},"extensions":{"book":{"multiFile":true}}},"pdf":{"identifier":{"display-name":"PDF","target-format":"pdf","base-format":"pdf"},"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","reference-location":"margin","output-file":"05-chapter.pdf"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"block-headings":true,"bibliography":["references.bib"],"documentclass":"scrreprt","title":"Simulation","author":"X Y (Chair)","citation-location":"margin"},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["html","pdf"]}